services:
  server:
    environment:
      - LAKEKEEPER__S3_ENABLE_DIRECT_SYSTEM_CREDENTIALS=false
      - LAKEKEEPER__S3_ENABLE_SYSTEM_CREDENTIALS=true
      - LAKEKEEPER__S3_REQUIRE_EXTERNAL_ID_FOR_SYSTEM_CREDENTIALS=true
      - AWS_ACCESS_KEY_ID=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_SECRET_ACCESS_KEY}
      - AWS_DEFAULT_REGION=eu-central-1
 
  spark:
    environment:
      - LAKEKEEPER_TEST__AWS_S3_ASSUME_ROLE_ARN=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_S3_ASSUME_ROLE_ARN}
      - LAKEKEEPER_TEST__AWS_S3_ASSUME_ROLE_EXTERNAL_ID=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_S3_ASSUME_ROLE_EXTERNAL_ID}
      - LAKEKEEPER_TEST__AWS_S3_USE_SYSTEM_IDENTITY=true
      - LAKEKEEPER_TEST__AWS_S3_ACCESS_KEY=
      - LAKEKEEPER_TEST__AWS_S3_SECRET_ACCESS_KEY=
      - LAKEKEEPER_TEST__AWS_S3_REGION=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_S3_BUCKET_REGION}
      - LAKEKEEPER_TEST__AWS_S3_BUCKET=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_S3_BUCKET}
      - LAKEKEEPER_TEST__AWS_S3_KEY_PREFIX=${LAKEKEEPER_TEST__SYSTEM_IDENTITY_AWS_S3_KEY_PREFIX}
      - LAKEKEEPER_TEST__AWS_S3_STS_ROLE_ARN=
